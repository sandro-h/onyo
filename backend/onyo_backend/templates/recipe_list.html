<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <link rel="icon" type="image/x-icon" href="/static/logo192.png">
    <link rel="stylesheet" href="/static/style.css">
    <style type="text/css">
        ul {
            padding-left: 1em;
        }

        li {
            list-style-type: none;
        }

        .hidden {
            display: none !important;
        }

        nav {
            display: flex;
            flex-direction: row;
            align-items: center;
        }

        nav>h1 {
            flex-grow: 1;
        }

        section {
            text-align: center;
        }

        .icon-l {
            float: left;
            opacity: 0.6;
        }

        .icon-r {
            float: right;
            opacity: 0.6;
        }

        .control-btn {
            margin-left: 0.5em;
        }
    </style>
    <script type="text/javascript">
        let lastPick = -1;

        function main() {
            document.getElementById('random-btn').addEventListener('click', _ => pickRandom());
            document.getElementById('all-btn').addEventListener('click', _ => showAll());
        }

        function pickRandom() {
            const meals = document.querySelectorAll('section li');

            let pick = -1;
            do {
                pick = Math.floor(Math.random() * meals.length);
            } while (pick == lastPick || meals.length == 1);
            lastPick = pick;

            document.getElementById('all-btn').classList.remove('hidden');

            meals.forEach((m, i) => {
                if (i !== pick) {
                    m.classList.add('hidden');
                }
                else {
                    m.classList.remove('hidden');
                }
            })
        }

        function showAll() {
            const meals = document.querySelectorAll('section li');
            meals.forEach((m, i) => {
                m.classList.remove('hidden');
            })
            document.getElementById('all-btn').classList.add('hidden');
        }

        document.addEventListener('DOMContentLoaded', main);
    </script>
</head>

<body>
    <main>
        <nav>
            <h1><a href="/">&#9001; {{ category.name }}</a></h1>
            <a id="all-btn" class="control-btn hidden" href="#">Show all</a>
            <a id="random-btn" class="control-btn" href="#">Random</a>
        </nav>
        <section>
            <ul>
                {% for recipe in category.recipes %}
                <li>
                    <a class="link-btn" href="/{{category.name}}/{{recipe.id}}">
                        <span class="icon-l">{{recipe.icon}}</span>
                        <span>{{recipe.name}}</span>
                        <span class="icon-r">{{recipe.icon}}</span>
                    </a>
                </li>
                {% endfor %}
            </ul>
        </section>
    </main>
</body>

</html>